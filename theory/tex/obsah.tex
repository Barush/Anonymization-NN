\chapter{Úvod}
	V prùbìhu vývoje internetových slu¾eb se stále zvy¹uje objem dat, která je mo¾no u¾ivateli v reálném èase pøedat. Výpoèetní technika se dostala tak daleko, ¾e je mo¾né u¾ivateli ukázat reálnou podobu míst, která jsou od nìj vzdálena tisíce kilometrù. S nespornými výhodami plynoucími z vývoje tímto smìrem v¹ak pøicházejí i mnohé problémy. Jde pøevá¾nì o problémy rázu prozrazení osobních údajù, kterým je tøeba se jak z legislativních, tak z etických dùvodù vyvarovat. V souèasné dobì se tato problematika øe¹í pomocí anonymizace zachycených dat. Právì tomuto tématu se tato diplomová práce bude vìnovat - anonymizaci SPZ vozidel zachycených na snímcích veøejného prostoru.

	Proto¾e v souèasné dobì máme díky neustálému zlep¹ování hardwaru k dispozici obrovský výpoèetní výkon, mù¾eme si troufnout i do øe¹ení tak obtí¾né úlohy jako je automatizovaná detekce a anonymizace obrazových dat. Díky velkému výpoèetnímu výkonu mohou být v této práci vyu¾ity hluboké neuronové sítì, jejich¾ uèení vy¾aduje velké mno¾ství strojového èasu.

	Cílem tohoto semestrálního projektu je polo¾it teoretický základ pro následující zpracování diplomové práce na téma anonymizace SPZ vozidel v obrazových datech. Tato práce probíhá ve spolupráci se spoleèností Seznam.cz a její výsledek by mìl pozdìji slou¾it k automatizované anonymizaci obrazových dat pro slu¾bu Panorama. 

	Tato práce je èlenìna do pìti kapitol. Po této úvodní kapitole následuje kapitola \ref{ch:personaldata}, která se v první polovinì (\ref{osobni_udaje}) zabývá platnou legislativou definující, jakým zpùsobem jsou osobní údaje v Èeské republice definovány a jak je tøeba s nimi nakládat. Ve druhé polovinì této kapitoly (\ref{ch:anonymization}) je potom rozebrána anonymizace nejen obrazových dat a její metody vyu¾ívané v souèasnosti. V následující kapitole \ref{ch:neuronky} je popsána návaznost umìlých neuronových sítí na biologický neuron, dále pak neuronové sítì a jejich pou¾ití v praxi. V kapitole \ref{ch:navrh} je na základì pøedchozích kapitol navr¾en program, který bude øe¹it automatizovanou anonymizaci obrazových dat s vyu¾itím neuronových sítí a detektoru hran. V kapitole \ref{ch:zaver} jsou potom shrnuty výsledky studia teorie pro tento semestrální projekt a pøedpokládaný vývoj této diplomové práce do budoucna.

\chapter{Osobní údaje a jejich ochrana}\label{ch:personaldata}

	Anonymizace dat je v dne¹ní dobì velmi aktuálním tématem. Intenzivnì se na ní pracuje jak na úrovni datové, tak na úrovni anonymizace obrazových dat, která je také pøedmìtem této práce. Pokud je spoleènost schopna zajistit kvalitní anonymizaci dat, která spravuje, nejen, ¾e tím plní svoje zákonné povinnosti, mù¾e si tím také vylep¹it svoje jméno v oèích zákazníkù a spoleèností, se kterými spolupracuje. 

	Tato kapitola se blí¾e zabývá legislativním podtextem ochrany osobních údajù v sekci , dále potom v sekci / popisem pojmu anonymizace dat a v sekci / jsou popsány
	metody, které se k anonymizaci dat pou¾ívají v souèastnosti. 

	\section{Základy ochrany osobních údajù v ÈR}\label{osobni_udaje}

		Ochrana osobních údajù v Èeské republice pøedstavuje soubor práv a povinností, které se vztahují k uchovávání a zacházení s daty pøímo se týkajícími dané fyzické
		osoby. Osobní údaje nemusí být v¾dy pøímo identifikující danou osobu (jako je napøíklad rodné èíslo, jméno a pøíjmenní, adresa trvalého bydli¹tì apod.). Za 
		osobní údaje jsou pova¾ovány jakékoliv údaje pøímo související se ¾ivotem konkrétní nebo urèitelné osoby. Mù¾e jít napøíklad o provozování koníèkù, èlenství v 
		politických stranách, úèast na specifických událostech, náv¹tìvy rùzných míst, velikost obleèení a podobnì. Ochrana osobních údajù (ochrana osobních dat) je v 
		Èeské republice regulována zákonem è. 101/2001 Sb., o ochranì osobních údajù a dal¹ími právními pøedpisy.

		Zákon rozli¹uje osoby, které zpracovávají osobní údaje (\emph{správce osobních údajù}) a osoby, jejich¾ data správci zpracovávají (\emph{subjekt osobních údajù}). Správcùm jsou
		zákonem ukládány pøedev¹ím povinnosti, zatímco subjektùm jsou dána práva. Dodr¾ování práv a povinností obou stran je v Èeské republice kontrolováno 
		prostøednictvím Úøadu na ochranu osobních údajù.

		Základní ideou ochrany osobních údajù je ta, ¾e osobní údaje jsou shroma¾dovány a zpracovávány za nìjakým úèelem. Ka¾dý úèel vy¾aduje jiný typ osobních údajù a také
		jiné mno¾ství takto zpracovávaných osobních údajù. Ve vý¹e uvedeném zákonì byly pro bli¾¹í specifikaci tìchto úèelù zavedeny pojmy úèel zpracování, prostøedky 
		zpracování, zpùsob zpracování, kategorie osobních údajù, kategorie subjektù údajù a kategorie pøíjemcù. V tìchto termínech je tøeba zpracovávání osobních údajù v¾dy pøedem popsat. \footnote{Výklad zákona 101/2001 Sb. dle http://www.oou.cz}

		V této práci se budu vìnovat zpracovávání obrazového materiálu nasbíraného na veøejném prostranství. Vzhledem k tomu, ¾e veøejné prostranství je v¾dy snímáno za 
		bì¾ného dne, spolu s terénem, který je snímán, jsou nasnímáni i lidé a dal¹í objekty, které se v daném prostranství pohybují. Jak bylo øeèeno døíve v této kapitole,
		ve¹keré informace, které mohou prozradit jakékoliv údaje pøímo související s ¾ivotem dané osoby jsou pova¾ovány za osobní údaje. Z toho vyplývá, ¾e i obrazový 
		materiál nasnímaný na veøejném místì obsahující cizí osoby nebo automobily obsahuje osobní údaje a je tøeba se vìnovat zpùsobu jejich zpracování.

		V dne¹ní digitální dobì máme k dispozici velké mno¾ství obrazových dat. V této práci se budu vìnovat datùm zachytávaným pro úèely vizualizace prostoru z mapy 
		nasbírané v rámci slu¾by \emph{Panorama} spoleènosti \emph{Seznam.cz}. Tato data jsou sbírána prostøednictvím speciálnì upravené panoramatické kamery, která je umístìna na 
		støe¹e vozidla. Toto vozidlo pøi prùjezdu zpracovávanou lokalitou snímá svoje okolí a poøízený obrazový materiál se poté zpøístupòuje ¹iroké veøejnosti. Publikování 
		obrazového materiálu, na kterém se vyskytují osobní údaje jako jsou SPZ vozidel, oblièeje kolemjdoucích a podobnì je velmi citlivou zále¾itostí. Aby bylo 
		minimalizováno riziko zneu¾ití tìchto údajù, byla zvolena mo¾nost anonymizace.

	\section{Anonymizace}\label{ch:anonymization}

		Anonymizovaná data jsou taková data, která nemohou vést pøímo k identifikaci konkrétního èlovìka. Pokud jsou data obsahující osobní údaje anonymizována, pøestávají podléhat 
		pøísným regulacím Zákona o ochranì osobních údajù a lze s nimi nakládat volnìji. 

		Hranici, kdy jsou data u¾ anonymizována nelze zcela jednoznaènì definovat a anonymizaci je 
		tøeba pro ka¾dou specifickou skupinu dat posuzovat individuálnì. Pouhé zaèernìní jména v dokumentech malé firmy napøíklad nemusí vést k tomu, ¾e konkrétní osoba nebude dle dal¹ích vodítek v dokumentech identifikovatelná. Pøíklad toho, ¾e stejná úroveò anonymizace nemusí mít v¾dy stejné výsledky lze sledovat porovnáním obrázkù \ref{spz_anonym} a \ref{oblicej_anonym}. Oba obrázky jsou zpracovány stejným rozostøovacím filtrem. U SPZ na obrázku \ref{spz_anonym} by bylo dekódování pùvodní poznávací znaèky automobilu obtí¾né. U fotografie \ref{oblicej_anonym} by v¹ak v pøípadì dodateèné informace, ¾e se jedná napøíklad o nìkterého ze zamìstnancù støedního podniku byla identifikace s velkou pravdìpodobností mo¾ná.

		\begin{figure}
						\centering
						\includegraphics[width=130mm]{fig/anonym_car.pdf}
						\caption{Anonymizovaná SPZ vozidla.}
						\label{spz_anonym}
		\end{figure}

		\begin{figure}
						\centering
						\includegraphics[width=130mm]{fig/anonym_face.pdf}
						\caption{Anonymizovaný oblièej.}
						\label{oblicej_anonym}
		\end{figure}

	\section{Metody vyu¾ívané v souèasnosti}

		Datová anonymizace dosáhla v souèasné dobì uspokojivé úrovnì. Úspì¹nì anonymizována jsou jak data v \texttt{pdf} dokumentech, tak v databázích. Datovou anonymizaci lze v dne¹ní
		dobì provádìt plnì automatizovanì prostøednictvím mnoha nástrojù jak komerèních, tak volnì dostupných.

		Anonymizace v obrazových datech zatím nedosáhla tak vysoké úrovnì a to hned z nìkolika dùvodù:
		\begin{enumerate}
			\item Anonymizace v obrazových datech je velmi aplikaènì specifická - není proto tak velký tlak na její vývoj
			\item Anonymizace obrazových dat je výpoèetnì nároènìj¹í ne¾ anonymizace na úrovni datové
		\end{enumerate}

		Anonymizace obrazových dat sestává ze dvou èástí: detekce èásti obrázku urèené k anonymizaci a vlastního procesu anonymizace. Je zøejmé, ¾e vlastní proces anonymizace
		u¾ není výpoèetnì nijak nároèný. Jedná se zpravidla o aplikaci rozostøení, pøípadnì o pøidání vrstvy, která plnì pøekrývá anonymizované èásti obrázku. 
		Problematická v¹ak je detekce èásti obrázku urèené k anonymizaci. 

		\subsection{Manuální anonymizace}

			Po dlouhou dobu byla anonymizace obrazových dat potøeba vìt¹inou na malém objemu dat (napøíklad ve zpravodajství a podobnì). V takovém pøípadì je naprosto dostaèující
			provádìt výbìr èásti obrázku, která je urèena k anonymizaci, manuálnì. 

			Kvalita takto anonymizovaného obrázku je velmi dobrá, proto¾e èlovìk pøímo vidí výsledek a doká¾e
			korigovat rozsah provedené úpravy tak, aby výsledný obrázek byl skuteènì anonymní. Na svoje limity tato metoda v¹ak nará¾í pøi nárùstu mno¾ství anonymizovaných dat.

			Pro pøedstavu, pøi zpracovávání dat pro slu¾bu Panorama vzniknou ka¾dý snímací den 4TB obrazového materiálu z ka¾dého snímajícího vozidla. Takové mno¾ství dat u¾ není
			v rozumném èase mo¾né zpracovávat manuálnì a tak je tøeba vytvoøit automatizovanou variantu. 

		\subsection{Automatizovaná anonymizace}

			Automatizovaná anonymizace obrazových dat je zatím na poèátku svého vývoje. Zásadním problémem automatizované anonymizace, hlavnì pøi anonymizaci SPZ vozidel, jsou chyby vzniklé pøi detekci SPZ. Ty jsou toti¾ èasto detekovány i na místech, na kterých se 
			sice na fotografii vyskytuje text, nikoliv v¹ak SPZ viz obrázek \ref{anonymized_bad} \footnote{Obrázek pochází z automatizovaného anonymizéru, který je aktuálnì pou¾íván ve spoleènosti Seznam.cz. Anonymizér byl nauèen pomocí blí¾e nespecifikovaného algoritmu strojového uèení.}. 

			Pøi pou¾ití anonymizovaných dat pro slu¾bu Panorama je tento druh chyb nepøijatelný. Jde toti¾ o omezení jednoho
			z dùle¾itých úèelù slu¾by Panorama. U¾ivatelùm slou¾í hlavnì pro lep¹í orientaci v terénu, který neznají. Pokud chce u¾ivatel slu¾bu vyu¾ít k rychlej¹ímu nalezení
			nìjaké prodejny, je naprosto ne¾ádoucí, aby v rámci automatické anonymizace SPZ vozidel bylo anonymizováno oznaèení nad vstupem této prodejny. V aktuálním
			stavu automatizované anonymizace je právì tato závada velmi èastá. V této práci bude ukázáno, jakým zpùsobem se tìmto chybám vyvarovat.

			\begin{figure}
				\centering
				\includegraphics[width=90mm]{fig/act_problems.png}
				\caption{Problémy stávajícího øe¹ení anonymizace SPZ v Panoramì. Chybnì anonymizované nápisy nad obchody jsou na obrázku vyznaèeny èervenou barvou.}
				\label{anonymized_bad}
			\end{figure} 			

	\section{Obrazová data}
		Obrazová data pro tuto práci byla dodána spoleèností Seznam.cz a.s. V této sekci bude popsán zpùsob, jakým jsou obrazová data pro slu¾bu Panorama snímána, a jak jsou dále zpracovávána ne¾ se dostanou ke koncovému u¾ivateli. Anonymizér, který je praktickým výstupem této práce je jen jedním èlánkem v sekvenci operací, která je nad ka¾dým zachyceným obrázkem provedena. 

		\subsection{Snímání fotografií}
			Fotografie jsou snímány speciálnì upraveným vozem s 15 kamerami rozmístìnými na støe¹e. Tyto kamery zabírají 360° okolí snímacího automobilu. Zpùsob, jakým jsou kamery na støe¹e automobilu umístìny, je znázornìn na obrázku \ref{snimaci_auto}\footnote{Fotografie pøevzatá z http://www.novinky.cz/internet-a-pc/348579-nova-skoda-octavia-bude-fotit-panorama-pro-mapy-cz.html}. Kamery jsou na snímací hlavì umístìny ve dvou øadách. První snímá dolní èást výsledné fotografie - v té je umístìno ¹est kamer. V horní øadì je kamer umístìno 9 a snímají hlavní èást obrazu. TODO:zjistit, jestli tam není je¹tì jedna kamera nahoøe - to by bylo 6-8-1.

			Pøi snímání se auto pohybuje rychlostí 70 km/h. Snímání se provádí na v¹ech 15 kamerách souèasnì ka¾dé 3 metry. Aby bylo mo¾né pozdìji fotografii co nejvíce pøiblí¾it tomu, jak prostøedí vnímá èlovìk, který se v nìm pohybuje, pøi ka¾dém snímku se zaznamená je¹tì sada metadat. Tyto zahrnují
			\begin{itemize}
				\item èíslo snímku
				\item celek (15 fotografií), do kterého snímek patøí a poloha v nìm
				\item datum snímání
				\item zemìpisná poloha snímacího auta v souøadnicích UTM 33
				\item $\omega$ -- úhel náklonu automobilu v pravolevém smìru (viz \ref{uhly:omega})
				\item $\varphi$ -- úhel náklonu automobilu v pøedozadním smìru (viz \ref{uhly:phi})
				\item $\kappa$ -- odklon smìru jízdy automobilu od severního smìru, dále oznaèováno pojmem \emph{heading}  (\viz \ref{uhly:kappa})
			\end{itemize}

			\begin{figure}
				\begin{minipage}{.33\linewidth}
					\centering
					\subfloat[]{\label{uhly:omega}\includegraphics[width=80mm]{fig/uhel_omega.png}}
				\end{minipage}%				
				\begin{minipage}{.33\linewidth}
					\centering
					\subfloat[]{\label{uhly:phi}\includegraphics[width=40mm]{fig/uhel_phi.png}}
				\end{minipage}%				
				\begin{minipage}{.33\linewidth}
					\centering
					\subfloat[]{\label{uhly:kappa}\includegraphics[width=30mm]{fig/uhel_kappa.png}}
				\end{minipage}%
				\caption{Zaznamenávané úhly pøi snímání fotomateriálu.}
				\label{uhly}
			\end{figure}

			Pro výpoèet jednotlivých úhlù jsou k dispozici speciální senzory. Pro zaznamenávání headingu jsou na autì dvì vysoce pøesné GPS jednotky, které na základì rozdílu svých GPS poloh doká¾í pøesnì urèit smìr, kterým se snímací automobil pohybuje. Náklony ve v¹ech smìrech jsou mìøeny pomocí \emph{inerciální jednotky} a \emph{odometru}. 

			\begin{figure}
				\centering
				\includegraphics[width=90mm]{fig/snimaci_auto.jpg}
				\caption{Automobil s 15 kamerami umístìnými na snímací hlavì na støe¹e.}
				\label{snimaci_auto}
			\end{figure} 

		\subsection{Ukládání fotografií}
			Pøi snímání ka¾dé 3 metry v rychlosti 70 km/h musí kamery poøizovat fotografie v plném rozli¹ení v rychlosti 6,48 fps. V tomto okam¾iku tedy vzniká problém obrovského mno¾ství dat, která je potøeba okam¾itì zpracovávat. Je¹tì pøedtím, ne¾ jsou fotografie ve dvou kopiích ulo¾eny na jeden ze ètyø 600GB SSD diskù je tøeba je pøevést z formátu \texttt{raw}, do kterého jsou poøizovány do formátu \texttt{jpeg}, ve kterém jsou ukládány a dále zpracovávány. Tento pøevod je provádìn na výkonné grafické kartì umístìné v kufru automobilu pomocí technologie \emph{CUDA}.

			Ve¹keré operace nad daty jsou provádìny v kufru automobilu, kam data ze støechy putují pøes vysokorychlostní datové kabely. Ka¾dá z 15 kamer je s poèítaèem spojena pomocí svojí vlastní 1 Gbitové linky. 

		\subsection{Se¹ívání fotografií}
			Jakmile se data dostanou z terénu, zaèíná rozsáhlá mno¾ina operací, která je nad nimi provádìna. Jako první pøijde na øadu se¹ívání snímkù. Pomocí nástroje navr¾eného ve spoleènosti Seznam.cz je z 15 fotografií zachycených v jednom okam¾iku vytvoøena jedinná ¹irokoúhlá fotografie, nad kterou se nadále pracuje. V rámci se¹ívání fotografií jsou také odstranìny èásti snímacího automobilu, které se dostaly do zábìru.

		\subsection{Vyrovnávání horizontu}
			Na fotografii se¹ité z 15 fotek je znaènì deformován horizont. Nyní tedy pøichází na øadu vyrovnání horizontu zachyceného prostøedí. Pro tuto operaci byly takté¾ navr¾eny algoritmy pøímo ve spoleènosti Seznam.cz. Vzor výstupu z této operace je znázornìn na obrázku \ref{vyrovnano}\footnote{Fotografie pøevzatá z archivu firmy Seznam.cz}. Aèkoliv obrázek nevypadá pøirozenì, po jeho namapování na kouli se ve¹keré deformace vyrovnají a vznikne vìrná kopie reálného prostøedí.
			\begin{figure}
				\centering
				\includegraphics[width=90mm]{fig/vyrovnano.jpg}
				\caption{360° fotografie po vyrovnání horizontu.}
				\label{vyrovnano}
			\end{figure} 			

		\subsection{Namapování na kouli}
			Výsledný obrázek je následnì namapován na kouli, na které u¾ je zobrazován koncovému u¾ivateli. Natoèení této koule v prostoru doká¾e dorovnat zakøivení, které vznikne vlivem snímání pod úhlem. V tomto okam¾iku jsou vyu¾ity zaznamenané úhly $\omega$ a $\varphi$, jejich¾ aplikace zamezí u¾ivatelskému pocitu \emph{padání obrazu}.

			\subsubsection{Ekvirektangulární projekce}
			Pro namapování obdélníkového obrazu na kouli je vyu¾ita ekvirektangulární projekce (v literatuøe té¾ oznaèována jako ekvidistantní projekce). Tato projekce vyu¾ívá pøepoèet souøadnic dle vztahù \ref{ekvi_x} a \ref{ekvi_y}, kde $x$ a $y$ jsou souøadnice na fotografii v rovinì, $\lambda$ znaèí zemìpisnou délku od centrálního poledníku v daném zobrazení, $\varphi$ znaèí zemìpisnou ¹íøku a $\varphi_1$ je parametr rovnobì¾ek, který urèuje rozsah skuteèné projekce. 

			\begin{equation}
				x = \lambda*cos(\varphi_1)
				\label{ekvi_x}
			\end{equation}

			\begin{equation}
				y = \varphi
				\label{ekvi_y}
			\end{equation}			

\chapter{Neuronové sítì}\label{ch:neuronky}

	Neuronové sítì jsou jednou ze tøí hlavních podskupin vìdního oboru soft computing. Dal¹ími problematikami, které tato vìdní disciplína zkoumá jsou fuzzy systémy a evoluèní algoritmy. Tato práce se vìnuje hlubokým neuronovým sítím pracujícím nad obrázkovými daty. Neuronové sítì jsou uvedeny do ¹ir¹ího kontextu v této kapitole, která je rozdìlena do nìkolika èástí. 

	V èásti \ref{ch:bioneuron} je zjednodu¹enì popsán biologický neuron, na jeho¾ funkci je celá teorie neuronových sítí zalo¾ena. V sekci \ref{ch:artneuron} je potom popsán zpùsob, jakým je v umìlé inteligenci funkènost biologického neuronu napodobována. V sekci \ref{ch:neuralnets} je popsáno, jakým zpùsobem jsou umìlé neurony spojovány do neuronových sítí a jakých výhod je tím dosa¾eno. V této èásti je dùle¾itá podkapitola \ref{ch:uceni}, kde je podrobnì popsán jeden z nejpou¾ívanìj¹ích algoritmù pro uèení neuronových sítí: \emph{backpropagation}. Tato kapitola je potom zakonèena èástí \ref{ch:deeplearning}, ve které jsou popsány slo¾itìj¹í koncepty hlubokých neuronových sítí, které budou vyu¾ity v této diplomové práci.

	\section{Biologický základ neuronových sítí}\label{ch:bioneuron}

		Pøi studiích v oborech biologie a biofyziky bylo bìhem posledních nìkolika dekád odhaleno mnoho principù, díky kterým se mù¾eme pøiblí¾it pochopení funkce na¹í nervové soustavy a mozku. Základní stavební jednotkou lidského tìla je buòka, základní stavební jednotkou nervové soustavy potom je \emph{neuron}. Hlavní souèásti neuronu jsou \emph{dendrity}, \emph{axony} a \emph{tìlo buòky (soma)}, jak je znázornìno na obrázku \ref{neuron}. Tìchto neuronù se v lidské nervové soustavì nachází cca $10^{11}$. \cite{MU2013_neurologie}

		\begin{description}
			\item[Dendrit] -- Vstupní bod neuronu. Pøes dendrity se do tìla neuronu dostávají elektricko-chemické vzruchy, jejich¾ pøenos je hlavní èinností neuronu.
			\item[Axon] -- Èást neuronu, která zaji¹»uje pøenos vzruchù. Je ukonèena \emph{axonálním zakonèením}, které je výstupním bodem neuronu a nachází se velmi blízko dendritu jiného neuronu.
			\item[Synapse] -- Spojení mezi dvìma neurony - pøesnìji mezi dendritem a axonálním zakonèením. V dne¹ní dobì není aktivita mozku mìøena v poètu neuronù, nýbr¾ právì v poètu synapsí.
			\item[Neurotransmiter] -- chemická látka, která zaji¹»uje pøenos informací v mozku. V této práci budu mluvit jen o pøenosu elektricko-chemického vzruchu v synapsi, ale neurotransmitery mají v nervové soustavì mnohem ¹ir¹í funkci.
			\item[Soma] -- tìlo buòky. Sleduje, zda-li suma velikosti nervových vzruchù pøicházejících z jednotlivých dendritù nepøesáhla daný práh a pokud se tak stane, vygeneruje nový vzruch.
		\end{description}

		\begin{figure}
			\centering
			\includegraphics[width=90mm]{fig/neuron.pdf}
			\caption{Schéma biologického neuronu. Na obrázku je zobrazeno \emph{jádro}, které uchovává genetickou informaci buòky, \emph{soma} je tìlo buòky, \emph{dendrity} jsou vstupní body neuronu, \emph{axon} jsou výstupní výbì¾ky tvoøené axonovými vlákny a \emph{axonální zakonèení} jsou výstupní místa neuronu.}
			\label{neuron}
		\end{figure} 

		V okam¾iku, kdy se v tìle neuronu nashromá¾dí dostateènì velký potenciál, zaène se ¹íøit nervovým vláknem (axonem) a¾ k axonálnímu zakonèení. Tady pøejde do dal¹ího neuronu. Velikost signálu pøená¹ená z dendritu do tìla neuronu závisí na síle impulzu sousedního neuronu, kterého se dendrit dotýká a také na \emph{synaptické váze}. V tìle neuronu se seètou hodnoty signálù od v¹ech aktivních dendritù. Pokud souèet hodnot pøekroèí jistý práh, soma vygeneruje nový impulz a tím se vzruch ¹íøí do dal¹ích neuronù. Bezprostøednì po vytvoøení pulzu se neuron stane na chvilku necitlivým. To má za následek generování nespojitého signálu, jeho¾ frekvence se mù¾e pohybovat v rozmezí 0,1-100Hz.

	\section{Umìlý neuron}\label{ch:artneuron}
		Princip biologického neuronu je napodobován umìlým neuronem. Základní model umìlého neuronu je zobrazen na obrázku \ref{art_neuron}, kde

		\begin{description}
			\item[\textbf{$x_i$}] je vstupní hodnota, která mù¾e být napojena na primární vstup nebo na výstup jiného neuronu. 
			\item[$w_i$] je váha propojení. Urèuje jak moc bude konkrétní vstup $i$ ovlivòovat výstup neuronu. Váhy se v prùbìhu výpoètu mìní - probíhá \emph{uèení}, pøípadnì pøes nemìnnou váhu mù¾e být pøipojen tzv. \emph{bias}. Ten není primárním vstupem ani výstupem jiného neuronu - jedná se o konstantu v¾dy vstupující do neuronu.
			\item[$u$] je hodnota vnitøního potenciálu neuronu.
		\end{description}

		\begin{figure}
			\centering
			\includegraphics[width=90mm]{fig/art_neuron.pdf}
			\caption{Obecné schéma umìlého neuronu, kde \overrightarrow{x} = ($x_1$, $x_2$, ... $x_n$) je vstupní vektor, \emph{u} je vnitøní potenciál a \emph{y} je výstupní hodnota.}
			\label{art_neuron}
		\end{figure}

		Jak je vidìt na obrázku \ref{art_neuron}, na vstup umìlého neuronu se pøivádí vektor èísel, ty jsou pronásobena vektorem vah, které mají zpravidla malé hodnoty (vìt¹inou v intervalu $<-1;1>$, pøípadnì $<-2;2>$), dále jsou nad nimi provedeny bázová a aktivaèní funkce (viz dále) a výstupem je jedinné èíslo. Umìlý neuron je tedy matematická struktura, která zpracovává èísla a na výstupu podává jiná èísla. \cite{Kulkarni1994}

		\begin{description}
			\item[Bázová funkce] - urèuje zpùsob výpoètu vnitøního potenciálu $u$ neuronu. Nejèastìji vyu¾íváná je lineární bázová funkce. Její vztah pro výpoèet vnitøního potenciálu je uveden ve vztahu \ref{base_linear}. Dal¹í z vyu¾ívaných bázových funkcí je radiální bázová funkce - viz vztah \ref{base_radial}. \cite{Zboril2015}
			\begin{equation}
				u = \sum_{i = 1}^n w_i \times x_i
				\label{base_linear}
			\end{equation}
			\begin{equation}
				u = \sqrt{\sum_{i = 1}^n (w_i \times x_i)^2}
				\label{base_radial}
			\end{equation}
			\item[Aktivaèní funkce] - té¾ nazývaná \emph{pøenosová funkce}, vyu¾ívá se pro ni symbol $\sigma$. Urèuje zpùsob výpoètu výstupu neuronu z jeho vnitøního potenciálu. Tøi neèastìji pou¾ívané aktivaèní funkce jsou znázornìny na obrázku \ref{aktivacni_fce}. Na ose x je v¾dy hodnota vnitøního potenciálu neuronu $u$, na ose y je potom výstupní hodnota neuronu $y$.

			\begin{figure}
				\begin{minipage}{.33\linewidth}
					\centering
					\subfloat[Skoková funkce.]{\label{aktivacni:skokova}\includegraphics[scale=.33]{fig/skokova.pdf}}
				\end{minipage}%				
				\begin{minipage}{.33\linewidth}
					\centering
					\subfloat[Sigmoida.]{\label{aktivacni:sigmoida}\includegraphics[scale=.33]{fig/sigmoida.pdf}}
				\end{minipage}%				
				\begin{minipage}{.33\linewidth}
					\centering
					\subfloat[Hyperbolický tangens.]{\label{aktivacni:tanhyp}\includegraphics[scale=.33]{fig/tanhyp.pdf}}
				\end{minipage}%
				\caption{Nejèastìji vyu¾ívané aktivaèní funkce.}
				\label{aktivacni_fce}
			\end{figure}
		\end{description}

		Jednoduchý umìlý neuron s jedním biasem a skokovou aktivaèní funkcí je v literatuøe oznaèován jako \emph{perceptron}. Perceptron byl poprvé pøedstaven Frankem Rosenblattem v roce 1958, matematický model neuronu v¹ak byl známý u¾ od roku 1943 a princip èinnosti biologického neuronu dokonce u¾ od konce 19. století.

		Pokud bychom chtìli perceptron vyu¾ít ke klasifikaci vzorkù do tøíd, narazíme na jeho základní problém. Doká¾e klasifikovat vzorky pøíslu¹ící pouze dvìma tøídám a tyto tøídy musí být \emph{lineárnì separovatelné}. Váhy, které se upravují v prùbìhu uèení perceptronu lze matematicky pøevést na vztah pro pøímku v n-rozmìrném prostoru. V rovinì lze tedy lineární separovatelnost ilustrovat rozdìlením na dvì poloroviny, kdy v jedné se nacházejí vzorky jedné tøídy a ve druhé se nacházejí vzorky tøídy druhé. Rozdíl mezi lineárnì separovatelnými a lineárnì neseparovatelnými problémy je znázornìn na obrázku \ref{separable}. Mezi lineárnì neseparovatelné problémy se øadí u¾ i tak jednoduchý problém jako je XOR dvou hodnot (viz \ref{separable_xor}). To znaènì omezuje obecnou vyu¾itelnost perceptronu a vzniká tak potøeba sdru¾ování neuronù do neuronových sítí.
		\begin{figure}
			\begin{minipage}{.5\linewidth}
				\centering
				\subfloat[Lineárnì separovatelná funkce AND.]{\label{separable:and}\includegraphics[scale=.4]{fig/and.pdf}}
			\end{minipage}%				
			\begin{minipage}{.5\linewidth}
				\centering
				\subfloat[Lineárnì neseparovatelná funkce XOR.]{\label{separable_xor}\includegraphics[scale=.4]{fig/xor.pdf}}
			\end{minipage}%		
			\caption{Problém lineární separovatelnosti.}
			\label{separable}
		\end{figure}

	\section{Vícevrstvé neuronové sítì}\label{ch:neuralnets}
		Neuronová sí» jse výpoèetním systémem, o kterém mù¾e být uva¾ováno jako o \emph{èerné skøíòce}, která pøijímá vstupy a produkuje výstupy. Neuronová sí» se skládá z nìkolika vrstev umìlých neuronù a hlavní zlep¹ení, které neuronové sítì pøiná¹ejí oproti samotným neuronùm je mo¾nost klasifikace lineárnì neseparovatelných problémù.

		Neuronové sítì jsou v praxi èasto nasazovány na nìkteré z komplikovaných problémù, jako napøíklad \cite{Eberhart_shi2007}:

		\begin{description}
			\item[Klasifikace] - na vstup je pøilo¾en vektor a na výstupu je získáno zaøazení daného vektoru do nìkteré z pøedem definovaných tøíd.
			\item[Hledání vzorù] - na vstup je pøilo¾en vzor a na výstupu je vygenerován výstup, který nejlépe odpovídá vzoru poskytnutému na vstupu.
			\item[Doplòování vzorù] - na vstup je pøilo¾en vektor znázoròující èást hledaného vektoru. Na výstup jsou potom dotvoøeny chybìjící èásti vzoru.
			\item[Odstraòování ¹umu] - na vstup je pøilo¾en za¹umìný obrázek a na výstupu je získán obrázek s odstranìným ¹umem.
			\item[Optimalizace] - na vstup je pøilo¾en systém, který správnì øe¹í danou optimalizaèní úlohu a na výstupu je získáno nové funkèní øe¹ení, které pøineslo zlep¹ení v nìkterém ze sledovaných parametrù (napø. rychost, spotøeba energie apod.).
			\item[Øízení] - na vstup je pøilo¾en aktuální stav øízení a stav, do kterého chceme, aby se øízení dostalo a na výstupu získáme sekvence krokù, která tento pøechod zajistí.
			\item[Simulace] - na vstup je pøilo¾en aktuální stav, pøípadnì i sekvence pøedchozích stavù øízení a na výstupu postupnì získáváme stavy, které odpovídají vývoji reálného systému z tìchto poèáteèních podmínek v èase.
		\end{description}

		\subsection{Topologie sítí}
			Aby bylo mo¾né pomocí neuronových sítí øe¹it i lineárnì neseparovatelné problémy, je tøeba podstatnì zeslo¾itit jejich architekturu. To se provádí vkládáním dal¹ích vrstev neuronù do sítí. Dùle¾itým faktorem pøitom je, aby jednotlivé vrstvy neuronové sítì mìly nelineární aktivaèní funkci. Pokud by toti¾ v¹echny vrstvy mìly lineární aktivaèní funkci, slo¾ením tìchto vrstev by pouze vznikla jiná lineární funkce a øe¹ení neuronové sítì by tedy stále bylo ekvivalentem hledání rovnice pøímky, která prostor øe¹ení rozdìlí na dvì poloroviny. 

			Dal¹ím z dùle¾itých faktorù pøi návrhu neuronových sítí jsou jednotlivá propojení. V prùbìhu vývoje se experimentovalo s mnohými nastaveními propojení. Nìkterá pou¾ívaná propojení jsou zobrazena na obrázku \ref{nets}. Plnì propojená sí», ve které je ka¾dý neuron propojen se v¹emi neurony svojí vrstvy, vrstev pøedchozích i následujících se postupnì vyvinula ve vrstvovou sí» (viz \ref{nets:vrstvova}). Ve vrstvové síti lze výstup ka¾dého neuronu vyu¾ít jako vstup nìkterého z neuronù ve stejné vrstvì, pøípadnì jako vstup kteréhokoliv neuronu v nìkteré z vrstev následujících. Odstranìním zpìtných vazeb v rámci jednotlivých vrstev vzniká acyklická sí» (viz \ref{nets:acyklicka}). V acyklické síti mù¾e být výstup ka¾dého neuronu pøipojen na vstup kteréhokoliv neuronu v nìkteré z následujících vrstev. V této práci se v¹ak budu vìnovat výhradnì výzkumu na dopøedných sítích. Dopøedná sí» (viz \ref{nets:dopredna}) vzniká omezením propojení acyklických sítí. V dopøedné síti mù¾e být výstup ka¾dého neuronu pøipojen pouze na vstup kteréhokoliv neuronu v logicky následující vrstvì neuronù. \cite{Handbook_springer2012}

			\begin{figure}
				\centering
				\begin{minipage}{.5\linewidth}
					\centering
					\subfloat[Vrstvová sí».]{\label{nets:vrstvova}\includegraphics[scale=1]{fig/vrstvova.pdf}}
				\end{minipage}%				
				\begin{minipage}{.5\linewidth}
					\centering
					\subfloat[Acyklická sí».]{\label{nets:acyklicka}\includegraphics[scale=1]{fig/acyklicka.pdf}}
				\end{minipage}\par \medskip		
				\begin{minipage}{.5\linewidth}
					\centering
					\subfloat[Dopøedná sí».]{\label{nets:dopredna}\includegraphics[scale=1]{fig/dopredna.pdf}}
				\end{minipage}%		
				\caption{Vícevrstvé neuronové sítì.}
				\label{nets}
			\end{figure}

			\subsubsection{Vícevrstvé sítì}
				Vícevrstvá neuronová sí» má více ne¾ dvì vrstvy neuronù. První vrstva se nazývá \emph{vstupní vrstva} a nad naètenými vstupy neprovádí ¾ádnou operaci. Do celkového poètu vrstev se vstupní vrstva v literatuøe vìt¹inou nezapoèítává. Poslední vrstva se nazývá \emph{výstupní vrstva}. Tato vrstva se do celkového poètu vrstev zapoèítává, proto¾e pracuje jako obyèejná vrstva neuronové sítì. A¾ její výstupy jsou namapovány pøímo na primární výstupy celé neuronové sítì. V¹echny dal¹í vrstvy mezi vstupní a výstupní vrstvou se nazývají \emph{skryté vrstvy} a poèítají se do celkového poètu vrstev. 

				V dopøedné neuronové síti je výstup ka¾dého neuronu ka¾dé vrstvy pøipojen na vstup v¹ech neuronù vrstvy následující. V ka¾dém z neuronù dal¹í vrstvy v¹ak mù¾e mít výstup aktuálního neuronu jinou dùle¾itost. Toto se nastavuje pomocí vah jednotlivých propojení. Pokud chceme nìkteré propojení úplnì eliminovat, jednodu¹e mu nastavíme váhu $0$ a daná hodnota nebude v následujícím neuronu vùbec uva¾ována.

				Váhy jednotlivých propojení se pro pøehlednost zapisují pomocí matic. V ka¾dé neuronové síti existuje jedna váhová matice pro ka¾dou dvojici za sebou následujících vrstev. Zápis jednotlivých vah je blí¾e popsán v èásti \ref{backpropagation}.

		\subsection{Uèení neuronových sítí}\label{ch:uceni}
			Nejdùle¾itìj¹í vlastností neuronových sítí je pochopitelnì schopnost najít øe¹ení daného problému. Toto hledání øe¹ení - \emph{uèení} - probíhá prostøednictvím zmìny vah jednotlivých propojení tak, aby neuronová sí» podávala co nejpøesnìj¹í výsledky pro daný problém. Stejná neuronová sí» v reakci na stejný vstup podá v¾dy stejný výstup. Nejobecnìj¹ím dìlením algoritmù pro uèení je na uèení s uèitelem a bez uèitele \cite{Eberhart_shi2007}.

			\begin{description}
				\item[Uèení s uèitelem] je proces, který vyu¾ívá vnìj¹ího uèitele nebo globálnì známou informaci. V ka¾dém cyklu uèení je vypoètena aktuální odchylka výstupu sítì od oèekávaného výstupu, která se potom minimalizuje. Hlavní problémy, kolem kterých se diskuze o uèení s uèitelem ubírá jsou kdy uèení ukonèit, jak èasto a jak dlouho vyu¾ívat k uèení jeden vzorek vstupu a jak vyu¾ívat informaci o vývoji uèení a zmìnì chyby. Uèení s uèitelem lze dále rozdìlit na \emph{strukturální uèení s uèitelem}, kde hodnota výstupu sítì závisí pouze na aktuálních hodnotách na vstupu, zatímco u \emph{temporálního uèení s uèitelem} aktuální hodnota výstupu závisí i na vstupech a výstupech z pøedchozích cyklù uèení.
				\item[Uèení bez uèitele] je té¾ nazýváno \emph{samo-organizace}. Nebere v potaz ¾ádného vnìj¹ího uèitele a pracuje pouze s informacemi známymi bìhem uèení. Algoritmy uèení bez uèitele se sna¾í zorganizovat trénovací data a nalézt v nich co nejspecifiètìj¹í spoleèné vlastnosti. 
			\end{description}

			Dále v¹ak lze uèení dìlit podle dal¹ích kritérií, jedním z nich je uèení \emph{on-line} a \emph{off-line}.

			\begin{description}
				\item[Off-line uèení] je metoda uèení, pøi které je sí» nejprve trénována na celé mno¾inì dat a a¾ v okam¾iku, kdy pro ka¾dý vstupní vektor podává oèekávané výsledky, váhy jednotlivých propojení jsou uchovány a sí» je nasazena do provozu, kde u¾ se nemìní. Výhodou takto nauèené sítì je nespornì to, ¾e se chová velmi pøedvídatelnì a pro ka¾dý vstup podá korektní výstup. Nevýhodou v¹ak je, ¾e v okam¾iku, kdy chceme do mno¾iny dat pøidat dal¹í vstup, celá sí» musí být znova natrénována. Dal¹í nevýhodou tìchto metod uèení je, ¾e u¾ v okam¾iku uèení musí být k dispozici v¹echny mo¾né kombinace vstupù s jejich oèekávanými výstupy a také ¾e uèení mù¾e velmi dlouho trvat. Nejznámìj¹ím zástupcem tìchto metod uèení je algoritmus \emph{backpropagation}, který je popsán dále v této kapitole.
				\item[On-line uèení] je dynamiètìj¹í metoda uèení. Pokud je do tímto zpùsobem uèené sítì potøeba pøidat dal¹í vstupní vektor, je mo¾né to udìlat za bìhu bez ztráty døíve získané informace. Výhodou sítí uèených on-line tedy je mo¾nost uèení za bìhu. Pro komplikované, ale exaktnì definované problémy je v¹ak dnes výhodnìj¹í pou¾ívat metody off-line uèení. Výzvou do budoucnosti neuronových sítí v¹ak je pøijít s takovým algoritmem uèení, který by dosahoval pøesnosti off-line algoritmù, ale dokázal by pracovat s novými vstupními vektory za bìhu, tedy on-line.
			\end{description}

		\subsubsection{Uèení backpropagation}\label{backpropagation}
			Kdy¾ byl algoritmus backpropagation v roce 1986 pøedstaven Davidem Rumelhartem \cite{Rumelhart1986}, znamenalo to velký prùlom v uèení neuronových sítí. Na nìkterých neuronových sítích dosahoval oproti pøedchozím algoritmùm nìkolikanásobnì vy¹¹í rychlosti uèení. Tím umo¾nil vyu¾ití neuronových sítí k øe¹ení problémù, které do té doby byly neøe¹itelné. \cite{Nielsen2015}

			Pro ilustraci práce backpropagation nyní zaveïme zjednodu¹ující znaèení.
			\begin{description}
				\item[$w^l_{jk}$] znaèí váhu na propojení z $k$-tého neuronu $(l-1)$. vrstvy do $j$-tého neuronu $l$-té vrstvy neuronové sítì. 
				\item [$y^l_j$] je výstup $j$-tého neuronu v $l$-té vrstvì. 
				\item [$b^l_j$] je bias, který vstupuje do $j$-tého neuronu $l$-té vrstvy. 
			\end{description}
			Výstupní hodnotu ka¾dého neuronu lze tedy v souladu s touto notací zapsat jako 
			\begin{equation}
				y^l_j = \sigma\left(\sum\limits_{j,k} w^l_{jk} y^{l-1}_k + b^l_j\right)
				\label{out_neuron}
			\end{equation}
			Kde $\sigma$ je jeho aktivaèní funkce, $k$ jde pøes v¹echny neurony z vrstvy $l-1$ a $j$ jde pøes v¹echny neurony vrstvy $l$.

			Pro ka¾dou vrstvu $l$ je dále definovaná váhová matice $w^l$ (viz vztah \ref{w_matrix}), která pøehlednì znázoròuje v¹echny váhy. Hodnota, která se v matici nachází v $j$-tém sloupci $k$-tého øádku znaèí váhu, která se vyu¾ívá pøi propojení z $k$-tého neuronu $l - 1$. vrstvy do $j$-tého neuronu $l$-té vrstvy sítì. Podobným zpùsobem je definován vektor biasù $b^l$ pro ka¾dou vrstvu a vektor výstupních hodnot $y^l$, také pro ka¾dou vrstvu. Oba dva obsahují postupnì hodnoty pro v¹echny neurony dané vrstvy od $1$ do $n$. Na vý¹e definované vektory lze také aplikovat aktivaèní funkci $\sigma$, kdy platí vztah \ref{sigma}.

			\begin{equation}
				w^l = 
				\begin{bmatrix} w_{11} & w_{21} & \cdots & w_{n1} \\
							    w_{12} & w_{22} & \cdots & w_{n2} \\
							    \vdots & \vdots & \ddots & \vdots \\
							    w_{1m} & w_{2m} & \cdots & w_{nm}
				\end{bmatrix}
				\label{w_matrix}
			\end{equation}
			\begin{equation}
				 \sigma \left[ \begin{array}{c} x_1 \\ x_2 \\ x_3 \end{array} \right] = \left[ \begin{array}{c} \sigma (x_1) \\ \sigma (x_2) \\ \sigma (x_3) \end{array} \right]
				\label{sigma}
			\end{equation}

			Se zavedeným zápisem u¾ lze vztah pro výpoèet výstupních hodnot vyjádøit pro celou jednu vrstvu zároveò, co¾ nám rovnou umo¾ní pøestat o neuronové síti pøemý¹let jako o mno¾inì neuronù, ale jako o mno¾inì vrstev, co¾ je pro úèely dal¹ího popisu praktiètìj¹í. Výpoèet tedy oproti vztahu \ref{out_neuron} zpøehledníme na vztah \ref{out_layer}.

			\begin{equation}
				y^l = \sigma\left(w^l y^{l-1} + b^l\right)
				\label{out_layer}
			\end{equation}
			\begin{equation}
				u^l = w^l y^{l-1} + b^l
				\label{win_layer}
			\end{equation}

			Souèástí vztahu \ref{out_layer} je také \emph{vektor vnitøních potenciálù} neuronù vrstvy $l$ - $u^l$ (viz \ref{win_layer}), která bude v následujícím výkladu takté¾ vyu¾ita.

			Chybu sítì pro aktuální vstupní vektor vypoèteme podle vztahu pro kvadratickou chybu sítì(viz \ref{cost_x}), kde $d(x)$ je oèekávaný výstup sítì pro vstup $x$, $y^L(x)$ je výstup poslední vrstvy sítì, tedy primární výstup sítì, pro vstup $x$. Pro celou mno¾inu vstupù se potom vyu¾ívá vztah \ref{cost_all}, podle kterého vypoèteme prùmìrnou chybu pro v¹echny vstupní vektory.

			\begin{equation}
				C_x = \frac{1}{2} \left(d\left(x\right) - y^L\left(x\right)\right)^2
				\label{cost_x}
			\end{equation}
			\begin{equation}
				C = \frac{1}{n} \sum\limits_{x} C_x = \frac{1}{2n} \sum\limits_{x} \left(d\left(x\right) - y^L\left(x\right)\right)^2
				\label{cost_all}
			\end{equation}

			Dále zavedeme operaci $\odot$, v literatuøe té¾ nazývanou \emph{Hadamardùv souèin}. Pro dvì matice o stejných dimenzích $m \times n$ $A$ a $B$ je matice $C = A \odot B$ maticí takté¾ o dimenzích $m \times n$, kde $C_{ij} = A_{ij} \times B_{ij}$. 

			Algoritmus backpropagation experimentálnì zji¹»uje, jaký vliv mají malé zmìny vah a biasù u jednotlivých neuronù na výslednou chybu sítì. Formálnì tedy jde o výpoèet parciálních derivací zapsaných ve vztahu \ref{derivatives}.

			\begin{equation}
				\frac{\partial C}{\partial w^l_{jk}} ,
				\frac{\partial C}{\partial b^l_j}
				\label{derivatives}
			\end{equation}

			V procesu uèení backpropagation tedy provádíme malé zmìny $\Delta u^l_j$ vnitøního potenciálu $j$-tého neuronu v $l$-té vrstvì a zji¹»ujeme, zda toto bude mít pozitivní vliv na výslednou chybu sítì $C$. Tyto zmìny vnitøního potenciálu jsou provádìny pomocí zmìny vah u jednotlivých propojení. Tyto jsou propagovány zpìt do celé sítì po výpoètu výstupu $y^L$ a chyby sítì $C$. Pro neurony výstupní vrstvy je hodnota $\Delta w^l_{jk}$ vypoètena podle vztahu \ref{delta_output}, kde $\delta^L_j$ je vypoètena podle vztahu \ref{error_output} a $\eta$ je konstanta pro uèení celé sítì nazývaná \emph{learning rate}, která se vìt¹inou pohybuje v intervalu $<0;1>$.

			\begin{equation}
				\Delta w^l_{jk} = \eta \delta^L_j y^{L-1}_{k}
				\label{delta_output}
			\end{equation} 

			\begin{equation}
				\delta^L_j = \frac{\partial C}{\partial y^L_j} \sigma \prime \left(u^L_j\right)
				\label{error_output}
			\end{equation}

			Pøevedení vztahu \ref{error_output} do maticové reprezantace, se kterou chceme pøi backpropagation pracovat u¾ není obtí¾né. Lze jej zapsat jako \ref{error_matrix}, kde $\nabla_y C$ je vektor, jeho¾ komponenty jsou parciální derivace $\frac{\partial C}{\partial y^L_j}$. Pro kvadratickou chybu sítì lze tedy tento vztah zjednodu¹it na vztah \ref{error_quadratic}.

			\begin{equation}
				\delta^L = \nabla_y C \odot \sigma \prime \left(u^L\right)
				\label{error_matrix}
			\end{equation}

			\begin{equation}
				\delta^L = (y^L - d) \odot \sigma \prime \left(u^L\right)
				\label{error_quadratic}
			\end{equation}

			Výpoèet $\delta^l$ pro ka¾dou dal¹í vrstvu se potom provádí od poslední vrstvy smìrem k první podle vztahu \ref{delta_hidden}, kde $\left(w^{l+1}\right)^T$ je transponovaná váhová matice pro následující vrstvu. V takovéto podobì ji lze vyu¾ít pro zpìtný pøenos chyby sítì k jednotlivým neuronùm pøesnì podle jejich významu pøi dopøedném prùchodu. Váhy pro jednotlivá propojení se potom zmìní o $\Delta w^l_{jk}$, který je pro skryté vrstvy vypoèten analogicky jako pro výstupní vrstvu dle vztahu \ref{delta_output}.

			\begin{equation}
				\delta^l = \left(\left(w^{l+1}\right)^T \delta^{l+1}\right) \odot \sigma \prime \left(u^L\right)
				\label{delta_hidden}
			\end{equation}

	\section{Hluboké neuronové sítì}\label{ch:deeplearning}
		V pøedchozích kapitolách této práce byly pojmem neuronové sítì v¾dy rozumìny plnì propojené sítì. Tedy takové, ve kterých existuje propojení mezi ka¾dými dvìma neurony le¾ícími v sousedních vrstvách. Pokud v¹ak neuronová sí» pracuje nad obrázky, tímto propojením se ztrácí prostorová informace. U hodnot pocházejících ze dvou sousedních pixelù mù¾eme pracovat se stejnou závislostí jako u hodnot pocházejících z pixelù z opaèných hran obrázkù. Pokud vezmeme v architektuøe sítì v potaz, ¾e nìkteré pixely obrázku se nachází v bezprostøední blízkosti, zatímco jiné dvojice pixelù spolu vùbec nesousedí, mù¾eme získat mnohem lep¹í výsledky.

		\begin{figure}[h]
			\centering
			\includegraphics[width=100mm]{fig/convolutional_layer.png}
			\caption{Schéma konvoluèní vrstvy sítì.}
			\label{convolutional}
		\end{figure}


\chapter{Návrh}\label{ch:navrh}

	V této kapitole je popsán návrh implementovaného programu. Cílem této práce je vyrobit nástroj, který doká¾e automaticky zpracovávat nafocené obrázky na vstupu a podávat anonymizované obrázky na výstupu. Práce s obrázky je rozdìlena do ètyø základních fází znázornìných na obrázku \ref{overall_scheme}, jejich¾ mechanismy budou v této kapitole podrobnì popsány. Barevné ¹ipky v obrázku \ref{overall_scheme} znázoròují jednotlivé mezivýsledky pøi zpracování a stejná barevná notace je pou¾ita i v dal¹ích obrázcích této kapitoly.  

	\begin{figure}[h]
		\centering
		\includegraphics[width=150mm]{fig/overall.png}
		\caption{Základní struktura programu.}
		\label{overall_scheme}
	\end{figure}

	\section{Pøedzpracování dat}\label{ch:preprocessing}	
		Na primárním vstupu celého programu jsou pøijímány fotografie nasnímané v rámci sbìru dat pro slu¾bu Panorama. V¹echny dal¹í fáze u¾ v¹ak pracují nad èísly typu \emph{double}, pøedzpracování dat tedy spoèívá v reprezentaci celého obrázku pomocí èíselného vektoru. Tento èíselný vektor musí mít pro jednotlivé obrázky co nejlep¹í rozli¹ovací schopnost. Pokud je neuronová sí» natrénována ke klasifikaci dat o velké velikosti jednoho vzorku do \emph{n} tøíd, jejím hlavním úèelem je vyselektovat hodnoty, které jsou pro urèování tøíd podstatné - vytvoøit tzv. \emph{vektor rysù}. Tento vektor rysù, té¾ \emph{feature vector} je nejkondenzovanìj¹í informace z poèáteèních dat, výstupem z pøedzpracování dat je tedy právì feature vector.

		K extrakci feature vectoru byla v této práci vyu¾ita ji¾ nauèená neuronová sí» \emph{Ilsvrc}, je¾ vznikla pøi pøíle¾itosti \emph{ImageNet Large Scale Visual Recognition Challenge 2015} - odtud zkratka Ilsvrc. Tato výzva se koná ka¾doroènì a je zamìøena na algoritmy pro lokalizaci a detekci objektù v obraze a pak také na klasifikaci scény. Sí» Ilsvrc byla nauèena na mno¾inì obrázkù \emph{ImageNet}, která obsahuje více ne¾ 14 milionù obrázkù rozøazených do 1\0000 kategorií. 

		Tato sí» byla v rámci této práce pomocí \emph{finetuningu} (viz èást \ref{finetuning}) optimalizována pro klasifikaci mno¾iny obrázkù bli¾¹í obrázkùm, se kterými budu v rámci této práce pracovat. Pro dal¹í pou¾ití není vyu¾íván primární výstup klasifikace (viz obrázek \ref{preprocessing}). Ze sítì je extrahován vektor rysù, jeho¾ informaènì nejbohat¹í varianta se nachází v pøedposlední vrstvì sítì, která nese název \emph{FC7}.

		\begin{figure}[h]
			\centering
			\includegraphics[width=130mm]{fig/preprocessing_nn.png}
			\caption{Schéma pøedzpracování dat.}
			\label{preprocessing}
		\end{figure}			 

		\subsection{Finetuning}\label{finetuning}
			\emph{Finetuning} je metoda vyu¾íváná v pøípadì, ¾e u¾ máme úspì¹nì natrénovanou sí» a chceme ji vyu¾ít ke klasifikaci na podobná data. Stadardnì se na poèátku tréninku neuronové sítì na nový typ vstupu v¹echny váhy inicializují náhodnì. Pokud v¹ak máme k dispozici sí», která je u¾ nauèená na velké mno¾inì obrázkù, mù¾eme namísto náhodné inicializace nové sítì inicializovat váhy nové sítì na výsledné váhy nauèené sítì. Proces uèení této sítì se potom nazývá \emph{finetuning}. Ten lze provádìt více zpùsoby. Nejznámìj¹ími z nich jsou:

			\begin{itemize}
				\item Úpravou vah pouze v poslední vrstvì
				\item Pøidáním nìkolika nových vrstev do nauèené neuronové sítì
			\end{itemize}

			Základním principem finetuningu je to, ¾e do vah v nauèené èásti sítì není pøíli¹ zasahováno. V pøípadì úpravy vah pouze v poslední vrstvì jsou ostatní váhy striktnì zachovány ve svojí pùvodní podobì. V pøípadì pøidání nových vrstev do nauèené sítì je tato celá zachována ve svojí pùvodní podobì a uèení probíhá pouze na nových vrstvách vzniklé sítì.

	\section{Detekce aut v obrázku}

		Neuronová sí» provádìjící detekci automobilù v obrázku je stì¾ejní èástí této diplomové práce. Je to té¾ její hlavní implementaèní èást. Cílem je získat neuronovou sí», je¾ na vstupu dostane feature vektor vytvoøený v rámci pøedzpracování dat a na výstupu podá informaci, kde se v analyzovaném obrázku nachází automobil. 
		
		\begin{figure}[h]
			\centering
			\includegraphics[width=130mm]{fig/car_detection_nn.png}
			\caption{Schéma detekce aut v obrázku.}
			\label{car_detect}
		\end{figure}

		Trénování neuronové sítì pro detekci automobilù bude provedeno na datové mno¾inì, která bude v¾dy obsahovat právì jedno nebo ¾ádné auto. Výstup této sítì tedy bude binární - na obrázku je auto/na obrázku není auto. V rámci jednoho obrázku se v¹ak mù¾e nacházet více aut, proto je tøeba vytvoøit zpùsob, jakým detekovat v¹echna auta. Pro tuto práci jsem zvolila techniku, kdy na poèátku, je¹tì pøed pøedzpracováním dat dle kapitoly \ref{ch:preprocessing}, bude vstupní fotografie rozøezána na nìkolik podèástí, které budou zkoumány samostatnì. Neuronová sí» pro detekci automobilù pro ka¾dou podèást podá výstup na obrázku je/není auto. Tyto hodnoty budou potom umístìny zpátky na pùvodní pozice a tím bude vytvoøena \emph{heatmapa}. Na obrázku \ref{rozsek+sloz} mù¾eme vidìt postup tvorby heatmapy: výøezy, ve kterých nebylo nalezeno auto jsou znázornìny èervenou barvou, výøezy, ve kterých bylo nalezeno auto jsou znázornìny barvou zelenou. Na místech, kde se pøekrývá zelená barva se zelenou je nejvy¹¹í pravdìpodobnost výskytu auta. Naopak pøi pøekryvu èervených ploch je pravdìpodobnost nejmen¹í. Pøi pøekryvu èervené a zelené plochy je pravdìpodobnost výskytu auta malá.

		 Výøez, ve kterém byla zji¹tìna nejvy¹¹í pravdìpodobnost výskytu automobilu je na obrázku zvýraznìn zeleným rámeèkem. Vzniklý výøez bude pro dal¹í fáze zpracování identifikován ètyrmi souøadnicemi: $x_1$ a $y_1$, které identifikují souøadnice levého horního rohu obdélníku, ve kterém se nachází auto a $x_2$ a $y_2$, které identifikují souøadnice pravého dolního rohu tohoto obdélníku.

		\begin{figure}
			\begin{minipage}{.5\linewidth}
				\centering
				\subfloat[]{\label{rozsek:a}\includegraphics[scale=.6]{fig/rozsekani.png}}
			\end{minipage}%				
			\begin{minipage}{.5\linewidth}
				\centering
				\subfloat[]{\label{rozsek:b}\includegraphics[scale=.6]{fig/slozeni.png}}
			\end{minipage}%		
			\caption{Rozdìlení obrázku na podèásti a následné vytvoøení heatmapy}
			\label{rozsek+sloz}
		\end{figure}

	\section{Detekce SPZ ve vybrané èásti obrázku}
		Dal¹í navazující èástí této práce je detekce SPZ ve výøezech s pravdìpodobným výskytem automobilu urèených výstupy pøedchozího kroku. V této èásti se budu vìnovat dvìma mo¾ným zpùsobùm, které v rámci této práce budou porovnávány. Zpùsob, jakým tato èást bude pracovat je jednodu¹e znázornìn na obrázku \ref{plate_detect}, kde v rámci implementace výpoèetního bloku budou porovnávány následující mo¾nosti:

		\begin{description}
			\item[Detektor hran] - sada matematických metod slou¾ících k hledání výrazných (nespojitých) zmìn jasu v obrazu. Toto lze provádìt buïto na základì vy¹etøování funkce jasu a jejích derivací nebo na základì analýzy frekvencí v obraze. Mezi mnoha hranovými detektory je nejvýraznìj¹í \emph{Cannùv hranový detektor}, pøedstavený Johnem Cannym v roce 1986 \ref{LITERATURA!!!}. Tento detektor je zalo¾en na Gaussovském rozostøení obrazu. Hrany detekuje pomocí hledání orientace gradientu a smìrových derivací. Funguje velmi dobøe pøi výskytu spojitých a dostateènì silných hran. Výsledný obraz je velmi ostrý, ale ne pøíli¹ detailní.
			\item[Neuronová sí»] bude nasazena hlavnì pro porovnání s detektorem hran. Nauèení neuronové sítì samozøejmì bude výpoèetnì nároènìj¹í, nicménì pokud by výsledky byly výraznì lep¹í ne¾ u konvenèního øe¹ení, bude stále neuronová sí» ve výsledku lep¹ím øe¹ením. 
		\end{description}

		Výstupem detekce SPZ ve vybrané èásti obrázku je opìt obdélník, který je identifikován ètyømi souøadnicemi: $x_1$ a $y_1$ identifikujícími levý horní roh SPZ a $x_2$ a $y_2$ identifikující pravý dolní roh SPZ.

		\begin{figure}[h]
			\centering
			\includegraphics[width=130mm]{fig/plate_detection.png}
			\caption{Schéma detekce SPZ ve vybrané sekci obrázku}
			\label{plate_detect}
		\end{figure}

	\section{Zatemnìní SPZ}
		Poslední fází zpracování je namapování detekované SPZ zpìt do celého vstupního obrázku bez výøezù a její rozmazání. Souøadnice výøezu, ve kterém byla SPZ vyhledávána jsou známy z pøedchozího kroku zpracování. Namapování SPZ zpìt do souøadnic celé Panorama fotografie tedy bude provedeno prostým souètem souøadnic $[x_1^{vyrez} + x_1^{SPZ}, y_1^{vyrez} + y_1^{SPZ}]$.

		Pro potøeby této diplomové práce bude postaèující pøes celou SPZ umístit neprùhledný obdélník, který znemo¾ní její èitelnost. Pro vyu¾ití v praxi v¹ak bude nutné zvolit jinou variantu, aby anonymizované SPZ vozidel v Panorama zobrazení nepùsobily pøíli¹ ru¹ivì. Nejvhodnìj¹í bude pou¾ít nìkterou z dostupných rozostøovacích funkcí, napøíklad \emph{gausovské rozostøení} nebo \emph{rozostøení pohybem}.

\chapter{Závìr}\label{ch:zaver}
	V rámci semestrálního projektu jsem prostudovala principy a metody vyu¾ívané pro detekci a anonymizaci SPZ vozidel zachycených na fotografiích a nástroje vyu¾íané v souèasnosti. Dále jsem také analyzovala, které problémy souèasná øe¹ení doká¾í zpracovávat dobøe a které jsou naopak jejich slabými stránkami.

	Ve spolupráci se zamìstnanci firmy Seznam.cz jsem analyzovala obrazový materiál pro slu¾bu Panorama a zpùsob jeho sbìru. V souvislosti s tìmito materiály jsem také nastudovala platnou legislativu ohlednì zpracování osobních údajù a manipulace s nimi.

	Na základì získaných informací jsem navrhla program umo¾òující provádìt automatizovanou detekci a anonymizaci SPZ v obrazovém materiálu ze slu¾by Panorama s vyu¾itím metody zalo¾ené na hlubokých neuronových sítích. Tento program byl navr¾en s ohledem na to, aby mìl co nejvìt¹í potenciál odbourat problémy, se kterými se potýkají stávající komerèní øe¹ení.

	V prùbìhu dal¹í práce na této diplomové práci bude program popsaný v kapitole \ref{ch:navrh} implementován a otestován na mno¾inì dat ze slu¾by Panorama spoleènosti Seznam.cz. Následnì budou vyhodnoceny výsledky a tyto budou porovnány s výsledky stávajících øe¹ení.